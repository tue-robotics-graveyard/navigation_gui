var rosUrl="ws://"+window.location.hostname+":9090",pingInterval=5e3,pingTimeout=2e3,ros;!function(){"use strict";function o(){n(),e(),console.log("ros-connect-amigo initialized")}function n(){i=$("#reconnect"),r=$("#modalConnectionLost"),i.click(function(){ros.connect(rosUrl)}),ros=new ROSLIB.Ros({url:rosUrl}),ros.addListener("connection",function(o){console.log("rosbridge connection made",o),i.button("loading")}),ros.addListener("close",function(o){console.log("rosbridge connection closed",o),i.button("reset"),r.modal("show")}),ros.addListener("error",function(o){console.log("rosbridge connection error",o)}),ros.addListener("ping.ok",function(o){console.log("rosbridge ping with %i ms",o),r.modal("hide")}),ros.addListener("ping.timeout",function(o){console.log("rosbridge ping timeout of %i ms",o),ros.close()})}function e(){s=new ROSLIB.Service({ros:ros,name:"/get_alive_nodes",serviceType:"node_alive/ListNodesAlive"});var o;ros.addListener("connection",function(){setTimeout(t,pingTimeout),o=setInterval(t,pingInterval)}),ros.addListener("close",function(){clearInterval(o)})}function t(){var o=new ROSLIB.ServiceRequest({}),n=new Date;setTimeout(function(){-1!==n&&ros.emit("ping.timeout",pingTimeout)},pingTimeout),s.callService(o,function(){var o=new Date-n;n=-1,ros.emit("ping.ok",o)})}var i,r,s;$(document).ready(o)}();var random_color=function(){function o(){return t+=e,t%=1,n(t,.7,.8)}function n(o,n,e){return o=Math.floor(360*o),n=Math.floor(100*n),e=Math.floor(100*e),"hsl("+o+","+n+"%,"+e+"%)"}var e=.618033988749895,t=.3;return o}();$(document).ready(function(){function o(o){var e=n(o);i.html(t(e))}function n(o){return o.map(function(o){var n=random_color();return{color:n,name:o}})}var e=$("#objects-template").html(),t=Handlebars.compile(e),i=$("#objects-list"),r=new ROSLIB.Topic({ros:ros,name:"/locations_list",messageType:"std_msgs/String"});r.subscribe(function(n){o(n.data.split(","))});var s=new ROSLIB.Topic({ros:ros,name:"/nav_goal",messageType:"std_msgs/String"});i.on("click","button",function(o){var n=$(o.currentTarget).html().trim();console.log("click",n),s.publish({data:n})}),i.html(t({status:"loading"}))});